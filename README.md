# 正弦波の確率密度関数と累積分布関数の解析

このリポジトリでは、正弦波で与えられる交流信号の確率密度関数（PDF）と累積分布関数（CDF）を数値的に求め、グラフ化するPythonスクリプトを提供しています。

## 概要

正弦波信号の電圧値の分布は、時間軸上で一様にサンプリングした場合、特徴的な確率分布に従います。このスクリプトでは、以下の手順でPDFとCDFを計算します：

1. 正弦波の1周期分からランダムに時間を選択（0以上1以下の一様分布から取得）
2. ランダムに取得した時間の電圧値を記録
3. 適当なビン幅を設定して、記録値が特定のビンに収まる割合を求める（PDF）
4. 累積確率を計算してCDFを求める
5. 理論的なPDFおよびCDFと比較

## 必要条件

- Python 3.6以上
- NumPy
- Matplotlib
- SciPy

## 使用方法

基本的な使用方法：

```bash
python sine_wave_pdf.py
```

オプションを指定して実行：

```bash
python sine_wave_pdf.py --amplitude 100 --num-samples 50000 --output result.png
```

### コマンドラインオプション

| オプション | 説明 | デフォルト値 |
|------------|------|------------|
| `--amplitude` | 正弦波の振幅（V） | 141 |
| `--num-samples` | サンプル数 | 100000 |
| `--num-bins` | ヒストグラムのビン数 | 50 |
| `--num-demo-samples` | デモンストレーション用サンプル数 | 20 |
| `--output` | 出力ファイルパス | /workspace/sine_wave_pdf_and_cdf.png |
| `--seed` | 乱数シード | 42 |
| `--dpi` | 出力画像のDPI | 300 |

## 理論的背景

### 確率密度関数（PDF）

正弦波 V(t) = A·sin(2πt) のPDFは、アークサイン分布に従います：

f(V) = 1/(π√(A²-V²)) for -A ≤ V ≤ A

ここで、Aは振幅です。

### 累積分布関数（CDF）

正弦波のCDFは以下の式で表されます：

F(V) = (1/π)·arcsin(V/A) + 0.5 for -A ≤ V ≤ A

## 結果の解釈

- PDFは±A（振幅の最大値）付近で最大となり、0V付近で最小となります
- これは正弦波が最大値や最小値付近ではゆっくりと変化し、ゼロ交差点では速く変化するためです
- CDFはS字型のカーブを描き、V = 0での値は0.5となります（電圧が0V以下である確率が50%）
- 実効値（RMS）は A/√2 ≈ 0.707A となります

## ライセンス

MITライセンス